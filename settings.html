<html>
    <head>
        <title>Settings</title>
        <script src="settings.js"></script>
    </head>
 

      
      
 <!-- settings window  -->        
    
    <style>
        body{
            font-family: Arial;
            font-size: 11pt;
        }

        
        th{
            background-color: #444;
            color: #fff;
            border-collapse: collapse;
            text-align:left;
            font-size: 12pt;
            padding: 6px;
        }
        table{
            border-collapse: collapse;
            text-align:left;
        }
        tr{
            border-bottom: 2px solid #ccc;
            font-size: 10pt;
        }
        .cloneTableRow{
            border-bottom: 0px solid #ccc;
            font-size: 10pt;
        }

        td{
            padding: 6px;
        }
        h2{
            text-align:left; 
        }
        .instructHeader{
            color: CornflowerBlue; 
        }
        .left, h3, h4{
            text-align:left;   
        }
        .right{
            text-align:right;   
        }
        textarea{ 
            width: 100%;
        }
        iframe{
            width: 100%;
        } 
        
        .branchAction {
          width: 15%;
          text-align:right; 
        }  
        .branchName{
          width: 85%;
        }
        
        .cloneLocalFolder{
          width: 100%;
        }
        .localFolder {
          width: 40%;
        }
        .remoteURL {
          width: 44%;
        }
        .setURL {
          width: 8%;
          text-align:center;
        }   
        .repoAction {
          width: 8%;
          text-align:right; 
        } 
        code{
            color: #006400; 
            font-size: 11pt;  
        }
        
        
    </style>
    
     
    <!-- https://www.w3schools.com/howto/howto_js_collapsible.asp -->
    <style> 
        .collapsible {
          background-color: #777;
          color: white;
          cursor: pointer;
          padding: 8px;
          width: 100%;
          border: none;
          text-align: left;
          outline: none;
          font-size: 15px;
        }
        
        .active, .collapsible:hover {
          background-color: #555;
        }
        
        .collapsible:after {
          content: '\002B'; # Unicode character for "plus" sign (+) 
          color: white;
          font-weight: bold;
          float: right;
          margin-left: 5px;
        }
        
        .active:after {
          content: "\2212"; # Unicode character for "plus" sign (-) 
        }
        
        .content {
          padding: 0 18px;
          max-height: 0;
          overflow: hidden;
          transition: max-height 0.2s ease-out; 
        }
        
        .quickUnfold {
          transition: max-height 0.0s ease-out; 
        }

    </style>
    
    

<body> 
     
    <div id="outer-content">
            
        <div id="inner-content">
                
            <h2 id="header_Settings">Settings </h2>
        
            <hr>
                
                <iframe id="emptyTable_iFrame"  src="settings_empty.html" frameborder="0" > </iframe>

                

 <!--  TABLES  -->                 
 <div id="hide">   <!--  This div hides verything enclosed if empty repos list -->  
     
       
            
    <!--  REPO SETTINGS -- foldable header--> 
    <button class="collapsible" id="repoSettings">Repository settings :</button> 
                
        <div class="content" id="foldableDiv1" > 
        <h3>Repository table </h3>  
              
                <p><i>(you can add them again by dropping a folder into the main window) </i></p>
                
                <!--  REPOSITORY TABLE -->
                <table style="width:100%"> 
                    <thead><tr>
                        <th class="localFolder">Local folder</th>
                        <th class="remoteURL">Remote repository</th>
                        <th class="testURL"  style="text-align: center">Remote</th>
                        <th class="repoAction  style="text-align: center">Action</th>
                    </tr></thead>
                    <tbody id="settingsTableBody">
                    </tbody>
                </table>

                   
                <!--  HIDDEN -->
                
                <input id = "cloneFolderInputButton" 
                    type="file" nwdirectory directory multiple="false" 
                    style='visibility: hidden;' 
                    onchange="_callback('folderSelectButtonPressed',this)" 
                    name="img"/>  <!--  open-folder dialog -- will be used as a tool, and called from settings.js when pressing the generated "Folder" button for cloning--> 
 
            <br> 
            <br> 
            
            

            
                        
            <h3>Branches in selected project </h3>  
            
                <p> <u>Current project folder</u> : <span id="currentRepo"></span></p>
            
                <iframe id="emptyBranchTable_iFrame"  src="settings_empty.html" frameborder="0" > </iframe>
                

                <!--  BRANCH TABLE -->  
                <table style="width:100%;"> 
                    <thead ><tr>
                        <th class="localFolder">Branch</th>
                        <th class="branchAction">Action</th>
                    <tbody id="branchesTableBody">
                    </tbody>
                </table>    
    
        </div>    
            
 </div>
<br>  
  <!--  End hiding part  -->


       
    <!--  SOFTWARE SETTINGS -- foldable header--> 
    <button class="collapsible" id="softwareSettings">Software settings :</button> 
                
        <div class="content">              
                
            <h4>Visual</h4>  
                   
                <!--  Always on top -->
                <input type="checkbox" id="alwaysOnTop" name="name" value="true" onchange="_callback('checkboxChanged',this)" checked>
                <label for="alwaysOnTop"> Always on top</label><br>
                   
                <!--  On all workspaces (Mac and Linux virtual desktops) -->
                <input type="checkbox" id="onAllWorkspaces" name="name" value="true" onchange="_callback('checkboxChanged',this)" checked>
                <label for="onAllWorkspaces" id="labelForOnAllWorkspaces"> Show on all workspaces (Mac and Linux)</label><br>

                
            <h4>Git</h4>  
                <!--  Force commit before branch change -->
                <input type="checkbox" id="forceCommitBeforeBranchChange" name="name" value="true" onchange="_callback('checkboxChanged',this)" checked>
                <label for="forceCommitBeforeBranchChange"> Branch change not allowed, for changed files</label><br>
                
                 <!--  Auto-push to remote -->
                <input type="checkbox" id="autoPushToRemote" name="name" value="true" onchange="_callback('checkboxChanged',this)" checked>
                <label for="autoPushToRemote"> Auto-push to remote, when Store clicked</label><br>
                
                <!--  One stash stored per repository -->
                <input type="checkbox" id="onlyOneStash" name="name" value="true" onchange="_callback('checkboxChanged',this)" checked>
                <label for="onlyOneStash"> Store only latest stash (drop older stashes)</label><br>
                
                <!--  --no-ff merge (gitflow recommends this) -->
                <input type="checkbox" id="NoFF_merge" name="name" value="true" onchange="_callback('checkboxChanged',this)" checked>
                <label for="onlyOneStash"> Merge without fast-forward (easier to understand merges, as recommended by GitFlow model)</label><br>
             
             
             
              
            <h4>External tools</h4>  

            
                <p><i>(typically the same in both fields ) </i></p>
            
                <label for="gitDiffTool"> Diff tool</label><br>
                <input id="gitDiffTool" type="text" size="30" /><br><br>
                
                <label for="gitMergeTool"> Merge tool</label><br>
                <input id="gitMergeTool" type="text" size="30" placeholder="Name of merge tool"/><br><br>
            
                <p>
                PATH (see NOTE, in instructions below): <br><br>
                <span id='path'><span>
                </p>       
            <br>   
    
        </div><!-- foldable content -->
        <br>  
        
    <!--  INSTRUCTIONS  -->     
    <button class="collapsible" id="instructions">Instructions</button>
        <div class="content"> 
            
             <!-------------------------------------------------------------------------------------------->  
            <p><b>The settings sections </b> can be folded / unfolded. Click on the + or - sign to the right.<br>  
            </p>
            <hr>    
             <!-------------------------------------------------------------------------------------------->   
                    
            <h2 class="instructHeader">Section : "Repository Settings"</h2>
            <hr>    
             <!-------------------------------------------------------------------------------------------->  
            
                <p>The repository settings have two parts : 
                    <dl>
                        <dd><b>A : Repository table </b> , where you may select one of the repositories you have defined </dd>
                        <dd><b>B : "Branches in selected repository" table</b> , which shows the branches that exist in the selected repository  </dd>
                    </dl>     
                </p>
                
                <hr>                
                <!-------------------------------------------------------------------------------------------->     
           
                <h3>A - part I : The "Repository table"  &mdash;  top rows</h3> 
                
                    <p>All rows, except the last row, shows the settings for the repositories you have defined so far. </p>
                    
                    <p><b>The first column</b> "Local folder" shows the path to your active repositories, on your local pc.  The radio-button, can be used to select one 
                    row, and the second table below shows the branches in that selected repository</p>
                    
                    
                    <p><b>The second column</b> "Remote repository" shows the address to a connected remote repository.  If this is not defined, then you work with a local repository (
                    which is fine as long as you have a backup plan)</p>
                    
                    <p><b>The third column</b> has the "Set" button, which is used to test that the remote repository can be connected to, and at the same time storing the address</p>
         
                    <p><b>The forth column</b> has the "Forget" button, which is used remove the selected row from the list 
                    (it can always be added again, just as you did the first time by dropping the folder on the main window)</p>
         
                <hr>    
            
                <!--------------------------------------------------------------------------------------------> 
                <h3>A - part II : The "Repository table", cloning  &mdash;  last row</h3>  
                
                    Instead of starting with a local folder, you may connect with an existing repository (this process is called cloning).
                    
                     <p><b>Setting up clone </b> is very similar to adding the remote repository, above.<br> 
                    The cloning is set up in the last row of the "Repository table", and you define a local folder and the repository address from which you wish to copy. 
                    
                    </p>
                    
                    <ol>
                    <li><b>The "Folder" button </b> is used to select the folder, into which the cloned repository is copied.  
                    <li><b>The  text field in the "Remote repository" column </b> is used to define the remote repository address (url)   
                    <li><b>The  "Test" button </b> is used to verify that you can connect to the defined remote repository  
                    <li><b>The  "Clone" button </b> makes a copy of the remote repository in the selected folder, and connects your local copy to the remote repository
                    </ol>    
                    
                <hr>  
            
                <!--------------------------------------------------------------------------------------------> 
                <h3>Some words about remote repositories</h3>  
                
                It is already described, above, how you link your project to a remote repository; and also how you clone a remote repository to your local computer.
                This section describes how to set up user-names and passwords for remote repositories.
            
                    
                 <h4>Creating an account </h4> 
                     
                     
                     <p>There are multiple remote repository hosting services that you can use on internet. One popular site is 
                        <a href='https://github.com' onclick="require('nw.gui').Shell.openExternal( this.href );return false;">Github</a> (by Microsoft), which gives free accounts.    
                     </p>
                     
                    <p> Get an account, go to the web interface, and create a new repository.  
                        You will get a link on the format 
                        <code style = "margin-left: 15px"> https://github.com/JanAxelssonTest/test.git</code> <br>
                        which you need to copy.    
                    </p>
                    
                    
                 <h4>Using your link (address / url) </h4> 
                     
                                                    
                     <p>Paste the link to your repository into the text-field under "Remote repository". 
                        Modify by adding <code>user:password</code>, and an <code>@</code>-sign added : <br>
                        <code style = "margin-left: 15px">   https://USER:PASSWORD@github.com/USERNAME/REPOSITORY_NAME.git</code>.<br>
                        In the pasted link,  <br>
                        <code style = "margin-left: 15px">USER</code> , <code>PASSWORD</code> , <code>USERNAME</code> , <code>REPOSITORY_NAME</code> <br>
                        are exchanged with their proper values.  For instance :<br>
                        <code style = "margin-left: 15px">https://JanAxelssonTest:PASSWORD@github.com/JanAxelssonTest/test.git</code>
                     </p>  
                     
                                            
                     <p>The repository is set (and tested) by pressing the  <img style='vertical-align:middle;' src="images/seturl-button.png"  height="24" > button.
                        If the text becomes green, the remote repository is correctly defined.  If the text is red, check carefully for typing errors, and press the 
                        "Set" button again.
                     </p>     
                                             
                     <p>Adjust your remote repository text until the "Set" button creates a green text, then it should work.
                     </p>         
                     
                <hr>           
                <!--------------------------------------------------------------------------------------------> 

                <h3>B : The "Branches in selected repository"</h3>  
                
                    <p>The branches for a selected repository (in the repository table) are listed in all but the last row.  </p>
                    
                    <p>A branch may be deleted, obviously something you only do if you are done working on that branch.  This could mean 
                    either that 1) you have merged your work to another branch, or 2) that your work led to a dead-end and you wish to discard it.  
                    Press the "Delete" button, and confirm in the dialog poping up if you wish to delete this branch, or cancel. </p>
                    
                    <p>In the last row, you can add a new branch, by typing its name, and pressing the "Add branch" button.  
                    The branch name cannot contain all characters, so the text field stops you from typing forbidden characters </p>
                    
                
                <hr>               
            <!--------------------------------------------------------------------------------------------> 
            
            <h2 class="instructHeader">Section "Software Settings"</h2> 
            <hr>                                 
            <!--------------------------------------------------------------------------------------------> 
                <p>These are the software settings : 
                    <dl>
                        <dt><b>Visual</b></dt>
                            <dd><b>- Always on top </b> , makes the main window always be on top of other program windows </dd>
                            <dd><b>- Show on all workspaces </b> , shows the Pragma-git on all virtual workspaces (this is a Mac and Linus thing) </dd>
                            <br>
                        <dt><b>Git</b></dt>
                            <dd><b>- Branch change not allowed, for changed files </b> : 
                                Stops you from changing branch, if you have not Stored your data.  This is the safe way to work. </dd>
                            
                            <dd><b>- Auto-push to remote when Store clicked </b> : 
                                The "Store" button performs the git commands "Add", "Commit", and if this setting is selected "Push". Disabling stops the "Push" command from being automatically run </dd>
                            
                            <dd><b>- Store only latest stash (drop older stashes) </b> : 
                                Stops stash list to grow.  Typical workflow is to stash (store temporarily), and after a little while use stash pop to put back the data.
                                This settings reduce the risk that you pop more than one stash (and thereby gets an unintended result)</dd>
                                                         
                            <dd><b>- Merge without fast-forward </b> : 
                                This is default, and makes clearer merges.  This guarantees a commit when merging,
                                where the commit message clarifies the used workflow.  This is the recommended workflow in the popular "Gitflow" way to do branching.</dd>
                            <br>
                            
                        <dt><b>External tools</b></dt>
                            <dd><b>- Diff tool </b> , lets Pragma-git show you differences between different revisions. The diff-program must be installed separately.  One good diff program is "Meld", but there are tens of different programs to download </dd>
                            <dd><b>- Merge tool </b> , lets Pragma-git help you solve file conflicts where git cannot decide safely on its own (conflicts arising from Merges, or Pull from remote repository where work has been done in both places)  </dd>
                     </dl>     
                </p>
                
                <p><B>NOTE : </B> If the external diff/merge tools don't open, their path may not be accessible to Pragma-git.  
                This can be fixed, by creating a one-line text file named <code>path.txt</code> into the <code>.Pragma-git</code> folder, inside your home directory.
                This file should start with the operating system's path delimiter ("<code>;</code>" for Windows, "<code>:</code>" for Mac and Linux), followed by the path to the
                folder containing your diff and merge tools.  Example for mac :
                </p>
                <code>
                :/usr/local/bin
                </code>
                <br>
                <br>
            
        </div><!-- foldable content -->

    
        
        </div><!-- inner-content --> 
    </div><!-- content --> 

    
<!--          -->    
<!-- Dialogs  -->   
<!--          -->   

<!--  General alert dialog  --> 

<dialog id="alertDialog" style="width:50%;background-color:#C00;border:1px dotted black;">  
    <p> 
        <div id='alertTitle'></div><br>  
        <div id='alertMessage'></div>  
    </p>  
    <button id="no"
        onclick="document.getElementById('alertDialog').close();selectedBranch='';">
        OK
    </button>  
</dialog>  
                
                

<!--  Warning dialog for delete branch  --> 

<dialog id="deleteBranchDialog" style="width:50%;background-color:#C00;border:1px dotted black;">  
    <p>This will delete your local branch.<br>  
        Do your really want to remove the branch? 
    </p>  
    <button id="yes" 
        onclick="document.getElementById('deleteBranchDialog').close();_callback('deleteBranchClicked',selectedBranch);">
        Delete
    </button>   
    <button id="no"
        onclick="document.getElementById('deleteBranchDialog').close();selectedBranch='';">
        Cancel
    </button>  
</dialog>  
 

<!--  Warning dialog for force-delete branch  --> 

<dialog id="forceDeleteBranchDialog" style="width:50%;background-color:#C00;border:1px dotted black;">  
    <p>The branch was not fully merged.  This means that there is work that will get lost when you delete the branch.  <br>
        Delete the branch and loose non-merged work? 
    </p>  
    <button id="yes" 
        onclick="document.getElementById('forceDeleteBranchDialog').close();_callback('forceDeleteBranchClicked',selectedBranch);">
        Delete and loose
    </button>   
    <button id="no"
        onclick="document.getElementById('forceDeleteBranchDialog').close();selectedBranch='';">
        Cancel
    </button>  
</dialog>   
  
 
<script>  <!--  selectedBranch used in dialog   -->
    var selectedBranch;  // Will be set when clicking "Delete" (which is a dynamically generated link, created from javascript)
</script>



<!--  Collapsible headers  (https://www.w3schools.com/howto/howto_js_collapsible.asp)  --> 
<script>
    var coll = document.getElementsByClassName("collapsible");
    var i;
    
    for (i = 0; i < coll.length; i++) {
        coll[i].addEventListener(
        "click", 
        function() {
            this.classList.toggle("active");
            var content = this.nextElementSibling;
            if (content.style.maxHeight){
                content.style.maxHeight = null;
            } else {
                content.style.maxHeight = content.scrollHeight + "px";
            } 
            
        });
    }
</script>
                    


<!--  Onload, call javascript file  --> 
<script>
    window.addEventListener('DOMContentLoaded', (event) => {
        console.log('settings.html :DOM fully loaded and parsed');
        injectIntoSettingsJs(document);
        }
    );
    window.addEventListener('unload', (event) => {
        console.log('settings.html :DOM fully unloaded -- maybe window closed ');
        closeWindow(window);
        }
    );
</script>

 
</body>
</html>
